<div class = "container-fluid mt-2">
    <div class="row">
        <sprint-side-menu></sprint-side-menu>
        <div class="col-md-10">
            <a href="#!/integration/119" class="nav-link">Integration-119</a>
            <a target= "_blank" href="https://www.youtube.com/watch?v=1EJ2aRlfXUM&list=PLMEYlt-BRJcJUUFSUjULJSSUZRbvFALhQ" class="nav-link">demo-playlist</a>
            <a href="#!/project/103" class="nav-link">project-estoreexpress</a>
            <div class="grooveborder">
                <h6 class="text-center">BACKLOG-ZONE-1<span class="alignright"><strong>github repository: </strong><a href="https://github.com/madajee/estore-sfdc-system-api.git" target="_blank">estore-sfdc-system-api</a></span></h6>
                <h6>Dev Complete Trageted by: <i>Mid July</i></h3>
                <h6>Release planned in : <i>End July</i></h3>
                <h4>Features: [Products, Pricebook]</h4>
                <strong>Context: </strong>In dietcoke sprint, we developed mule integration with lead object and the automation allow us to create lead and the /convertlead endpoint enable has to create account, contact and opportunities. We will now work on automating the products and pricebooks. As we follow trailhead project: <a target= "_blank" href="https://trailhead.salesforce.com/content/learn/projects/manage-products-prices-quotes-orders" class="nav-link">Manage Products, Prices, Quotes, and Orders</a> the automation on product and pricebook will enable us to verify trailstep: <i>Create and Customize Products,</i> <i>Create Custom Price Books</i> with mule integration.
                    <ul>
                        <li>
                            Product2 is the salesforce object for persisting product records.
                        </li>
                        <li>
                            Pricebooks is created with header-detail object style with header object as Pricebook2 and pricebook entries in detail object as PricebookEntry.
                        </li>
                        <li>
                            Pricebook entries are identified with PricebookId, product code and currency code. We can retrieved the pricenookId from header table pricebook name (eg: Standard Price Book, Entperprise, Nonprofit)
                        </li>
                    </ul>
                    <ul>
                        <li><strong>Card-1: </strong>Spec for the trail step mentions 3 prodcuts [{Product Name: UMS Solar Panel Cleaning Residential, Product Code: SPC-R01},  {Product Name: SunPower Ground, Product Code: SPG-01}, {Product Name: GreenSun Ground, Product Code: SPG-02}] . Create a mule configuration file  product-obj in estore-sfdc-system-api and implement the resource POST /product.
                            <pre>
                                <code>
                                    [
                                    {
                                        "name": "UMS Solar Panel Cleaning Residential",
                                        "description": "Residential solar panel cleaning service package",
                                        "family": "Service Packages",
                                        "productcode": "SPC-R01",
                                        "productcurrency": "USD",
                                        "active": true
                                
                                    },
                                    {
                                        "name": "SunPower Ground",
                                        "description": "80-cell ground-mounted solar panel",
                                        "family": "Panels",
                                        "productcode": "SPG-01",
                                        "productcurrency": "USD",
                                        "active": true,
                                        "groundmount": true
                                    },
                                    {
                                        "name": "GreenSun Ground",
                                        "description": "60-cell ground-mounted solar panel",
                                        "family": "Panels",
                                        "productcode": "SPG-02",
                                        "productcurrency": "USD",
                                        "active": true,
                                        "groundmount": true
                                    }
                                ]
                                 </code>
                            </pre>
                        </li>
                        <li><strong>Card-2: </strong>Add the following get endpoints
                        <ul>
                            <li>
                                Retrieve products with Id
                            </li>
                            <li>
                                Retrieve products with product code list : Create the dynamic query with SQL IN operator in WHERE clause to pass the product codes and the value for IN clause can be created with dwl functions like map(), join() and  “++” operator.
                                <pre>
                                    <code>
product code list: ["SPC-R01","SPG-01","SPG-02"] <br>
%dw 2.0
output application/java
var condition = "(" ++ ((payload.productcodelist map () -> "'" ++ $ ++ "'") joinBy (",")) ++ ")"
\---
{
	"query" : "SELECT ID, Name, Description, Family, ProductCode, CurrencyIsoCode, IsActive FROM product2 where ProductCode IN "  ++ condition
}
                                     </code>
                                </pre> 
                            </li>
                        </ul>
                        </li>
                        <li><strong>Card-3: </strong>Add deleteleads resource with a  POST method and input as an array of IDs  and use the delete operation of the connector to delete the products.</li>
                    </ul>
                </p>
            </div>
            <div class="grooveborder">
                <h6 class="text-center">BACKLOG-ZONE-2<span class="alignright"><strong>github repository: </strong><a href="https://github.com/madajee/estore-sfdc-system-api.git" target="_blank">estore-sfdc-system-api</a></span></h6>
                <h6>Dev Complete Trageted by: <i>third week July</i></h3>
                <h6>Release planned in : <i>End July</i></h3>
                <h4>Features: [Products, Pricebook]</h4>
                    <ul>
                        <li><strong>Card-1: </strong>We require Admin to create the Pricebook records but we expose an resource to create the pricebookentry. The request payload for pricebookentry object requires a Product2Id and Pricebook2Id. We require 2 lookup query, one to retrieve the pricebook2Id with pricebook name and other to retrieve the product2Id with Product Code.</li>
                        <li><strong>Card-2: </strong>Add the following get endpoints to retrieve the pricebook entry based on pricebook, product and currency code. This will be used to get the correct unit price as same product can have different price in different pricebook. Use the following dwl to create the dynamic query:
                            <pre>
                                <code>
%dw 2.0
output application/json
var condition1 = "select Id, Name, CurrencyIsoCode, UnitPrice, ProductCode, Pricebook2.Name from PricebookEntry"
var condition2 = " WHERE Pricebook2Id = " ++ "':pricebookid'"
var condition3 = " AND ProductCode = " ++ "':productcode'"
var condition4 = " AND CurrencyIsoCode = " ++ "':currencycode'"
var condition5 = " LIMIT 10"
var condition = condition1 ++ (if (vars.pricebook[0].Id != null) condition2 else '') ++ (if (vars.queryparameters.productcode != null) condition3 else '') ++ (if (vars.queryparameters.currencycode != null) condition4 else '') ++ (if (vars.queryparameters.productcode == null and vars.queryparameters.currencycode == null) condition5 else '')
---
{
	"query" : condition
}
                                 </code>
                            </pre>
                        </li>
                        <li><strong>Card-3: </strong>With these resources implemented, one should able to understand and finish both the trail steps: <i>Create and Customize Products,</i> <i>Create Custom Price Books</i>  and complete the verification step in the trailhead playground.</li>
                    </ul>
                </p>
            </div>
            <div class="grooveborder">
                <h6 class="text-center">BACKLOG-ZONE-3<span class="alignright"><strong>github repository: </strong><a href="https://github.com/madajee/estore-sfdc-system-api.git" target="_blank">estore-sfdc-system-api</a></span></h6>
                <h6>Dev Complete Trageted by: <i>Augusgt</i></h3>
                <h6>Release planned in : <i>August</i></h3>
                <h4>Features: [Opportunity, Opportunity Products]</h4>
                <strong>Context: </strong>In diet-coke, walking-jogger sprint, we created an account: Ursa Major Solar, Inc with lead object automation and also created a service package and 2 panels with product2 object automation that sales teams at UMS will sell. Along with standard pricebooks, we created Nonprofit and Enterprise pricebook and created pricebook entries in USD and JPY. The next step in the <a target= "_blank" href="https://trailhead.salesforce.com/content/learn/projects/manage-products-prices-quotes-orders" class="nav-link">Manage Products, Prices, Quotes, and Orders</a> is to automate <i>updates on opportunity,</i> <i>by adding opportunity products</i> with mule integration.
                    <ul>
                        <li>
                            Opportunity is the salesforce object for persisting opportunity records and though we can create the opportunity record with UI, we will have an opportunity by converting the lead.
                        </li>
                        <li>
                            OpportunityLineItem is the salesforce object for persisting opportunity product records.
                        </li>
                    </ul>
                    <ul>
                        <li><strong>Card-1: </strong>As per trail spec, we require 2 accounts (Boy Scouts of the Southwest, Saito - Ground-mounted Panels) and each account should have an opportunity.
                            <ul>
                                <li>
                                    Boy Scouts of the Southwest will have an opportunity: BSofSW - Ground-mounted Panels.
                                </li>
                                <li>
                                    Saito Family Laundromats will have an opportunity: Saito - Ground-mounted Panels.
                                </li>
                            </ul>
                            We will convert a lead: John Doe who works for Boy Scouts by passing in the opportunity name and donotcreateopportunity as false to create the opportunity.
    <pre>
        <code>
            curl --location 'http://localhost:8081/api/convertlead' \
            --header 'Content-Type: application/json' \
            --data '{
                "name": "Jane Doe",
                "leadsource": "web",
                "doNotCreateOpportunity": false,
                "opportunityname": "Saito - Ground-mounted Panels"
            }'
            </code>
    </pre>
<pre>
    <code>
        curl --location 'http://localhost:8081/api/convertlead' \
        --header 'Content-Type: application/json' \
        --data '{
            "name": "John Doe",
            "leadsource": "web",
            "doNotCreateOpportunity": false,
            "opportunityname": "BSofSW - Ground-mounted Panels"
        }'
        </code>
</pre>
                        </li>
                        <li><strong>Card-2: </strong>We should able to query the created account and opportunity with lead conversion process. Add the opportunity-obj anc account-obj mule configuration file. Add the following get endpoints:
                        <ul>
                            <li>
                                opportunity by opportunity name
<pre>
    <code>
        curl --location 'http://localhost:8081/api/opportunity?opportunityname=Saito%20-%20Ground-mounted%20Panels'
        </code>
</pre>
                            </li>
                            <li>
                                account by account name.
<pre>
    <code>
        curl --location 'http://localhost:8081/api/account?accountname=Saito%20Family%20Laundromats'
        </code>
</pre> 
                            </li>
                        </ul>
                        </li>
                        <li><strong>Card-3: </strong>Saito Family Laundromats is operating as a Enterprise in Japan where as Boy Scout is operating as a Nonprofit, so we need to update the account currency to JPY. As per trail specs, we have enabled multicurrency amd setup JPY, SGD, GBP, EUR along with USD. Create a PUT endpoint to update account currency as JPY.
<pre>
    <code>
        curl --location --request PUT 'http://localhost:8081/api/account/{accountId}' \
        --header 'Content-Type: application/json' \
        --data '{
            "accountcurrency": "JPY"
        }'
        </code>
</pre>     
                        </li>
                        <li><strong>Card-4: </strong>Create a PUT endpoint to update opportunity to update the pricebook, currency and opportunity amount.
<pre>
    <code>
        Saito Family Laundromats

        curl --location --request PUT 'http://localhost:8081/api/opportunity/{opportunityId}' \
        --header 'Content-Type: application/json' \
        --data '{
            "opportunitypricebook": "Enterprise",
            "opportunitycurrency": "JPY",
            "opportunityamount": "4200000"
        
        }'
        </code>
</pre>
<pre>
    <code>
        Boy Scout

        curl --location --request PUT 'http://localhost:8081/api/opportunity/006bm000001oXrRAAU' \
        --header 'Content-Type: application/json' \
        --data '{
            "opportunitypricebook": "Nonprofit",
            "opportunitycurrency": "USD",
            "opportunityamount": "20000"
        }'
        </code>
</pre>     
                        </li>
                        <li><strong>Card-5: </strong>Add a nested resource /product to top level /opportunity resource and add the POST endpoint to create the opportunity products.
<pre>
    <code>
        Saito Family Laundromats

        curl --location 'http://localhost:8081/api/opportunity/product' \
        --header 'Content-Type: application/json' \
        --data '{
            "opportunityname": "Saito - Ground-mounted Panels",
            "products": [
                {
                    "productcode": "SPG-01",
                    "quantity": 35
                },
                {
                    "productcode": "SPG-02",
                    "quantity": 20
                }
            ]
        }'
        </code>
</pre>
<pre>
    <code>
        Boy Scout

        curl --location 'http://localhost:8081/api/opportunity/product' \
        --header 'Content-Type: application/json' \
        --data '{
            "opportunityname": "BSofSW - Ground-mounted Panels",
            "products": [
                {
                    "productcode": "SPG-02",
                    "quantity": 20
                }
            ]
        }'
        </code>
</pre>     
                        </li>
                        <li><strong>Card-6: </strong>Add a removeproduct to /opportunity /product resource and add the POST endpoint to remove  the opportunity products. With this method one can test adding and removing products multiple times from Postman.
<pre>
    <code>
curl --location 'http://localhost:8081/api/opportunity/removeproduct' \
--header 'Content-Type: application/json' \
--data '{
    "opportunityname": "Saito - Ground-mounted Panels",
    "products": [
        {
            "productcode": "SPG-01",
            "quantity": 35
        },
        {
            "productcode": "SPG-02",
            "quantity": 20
        }
    ]
}'
</code>
</pre>     
                        </li>
                    </ul>
                </p>
            </div>
        </div>
    </div>
</div>
<div class="grooveborder">
    <ul><h6 class="text-center">Helpful Links<span class="alignright"></h6>
        <li><a href="https://www.youtube.com/watch?v=rvigMkg8MYo" target="_blank">Agile Scrum Sessions with Dr. Jeff Sutherland | Value Stream Management</a></li>
        <li><a href="https://www.youtube.com/watch?v=Yto8nUeki-s" target="_blank">What is Value Stream Management? (Eric, IBM Cloud)</a></li>
    </ul>   
</div>