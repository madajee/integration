<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=YDAoLskQQ5MOAgvHUQCcLVIGZoPcmzM3evOREq3mXSoW57NJoHlxmjxIa3ntBA_Q);ul.lst-kix_ak3drdpnbdxf-2{list-style-type:none}.lst-kix_ak3drdpnbdxf-2>li:before{content:"\0025a0   "}.lst-kix_ak3drdpnbdxf-3>li:before{content:"\0025cf   "}ul.lst-kix_ak3drdpnbdxf-3{list-style-type:none}ul.lst-kix_ak3drdpnbdxf-4{list-style-type:none}ul.lst-kix_ak3drdpnbdxf-5{list-style-type:none}.lst-kix_ak3drdpnbdxf-1>li:before{content:"\0025cb   "}.lst-kix_ak3drdpnbdxf-5>li:before{content:"\0025a0   "}ul.lst-kix_ak3drdpnbdxf-0{list-style-type:none}ul.lst-kix_ak3drdpnbdxf-1{list-style-type:none}.lst-kix_ak3drdpnbdxf-6>li:before{content:"\0025cf   "}.lst-kix_ak3drdpnbdxf-7>li:before{content:"\0025cb   "}.lst-kix_ak3drdpnbdxf-0>li:before{content:"\0025cf   "}.lst-kix_ak3drdpnbdxf-8>li:before{content:"\0025a0   "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ul.lst-kix_ak3drdpnbdxf-6{list-style-type:none}.lst-kix_ak3drdpnbdxf-4>li:before{content:"\0025cb   "}ul.lst-kix_ak3drdpnbdxf-7{list-style-type:none}ul.lst-kix_ak3drdpnbdxf-8{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c36{margin-left:-0.8pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left;margin-right:-0.8pt}.c0{color:#cccccc;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Trebuchet MS";font-style:italic}.c32{background-color:#212121;padding-top:10pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c7{color:#dfdfdf;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Trebuchet MS";font-style:italic}.c9{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Trebuchet MS";font-style:italic}.c37{background-color:#1f1f1f;padding-top:10pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c8{padding-top:10pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c25{padding-top:10pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c31{font-size:9pt;font-family:"Courier New";font-style:italic;color:#f8f8f2;font-weight:700}.c22{color:#000000;font-weight:400;font-size:18pt;font-family:"Yellowtail";font-style:normal}.c21{font-size:12pt;font-family:"Trebuchet MS";font-style:italic;color:#d3d3d3;font-weight:700}.c3{font-size:10pt;font-family:"Trebuchet MS";font-style:italic;color:#cccccc;font-weight:700}.c10{font-size:9pt;font-family:"Courier New";font-style:italic;color:#808080;font-weight:400}.c6{font-size:12pt;font-family:"Trebuchet MS";font-style:italic;color:#f3b3d9;font-weight:700}.c23{color:#cbcbcb;font-weight:700;font-size:12pt;font-family:"Trebuchet MS";font-style:italic}.c27{font-size:10pt;font-family:"Trebuchet MS";font-style:italic;color:#000000;font-weight:700}.c29{font-size:9pt;font-family:"Courier New";font-style:italic;color:#dcdcdc;font-weight:700}.c28{font-size:9pt;font-family:"Courier New";font-style:italic;color:#569cd6;font-weight:400}.c4{font-size:12pt;font-family:"Trebuchet MS";font-style:italic;color:#ffb733;font-weight:700}.c19{font-size:12pt;font-family:"Trebuchet MS";font-style:italic;color:#cacaca;font-weight:700}.c11{font-size:12pt;font-family:"Trebuchet MS";font-style:italic;color:#dfdfdf;font-weight:700}.c15{font-size:9pt;font-family:"Courier New";font-style:italic;color:#9cdcfe;font-weight:400}.c12{font-size:12pt;font-family:"Trebuchet MS";font-style:italic;color:#50cbe4;font-weight:700}.c35{font-size:9pt;font-family:"Courier New";font-style:italic;color:#e6db74;font-weight:700}.c26{font-size:9pt;font-family:"Courier New";font-style:italic;color:#cccccc;font-weight:400}.c16{font-size:12pt;font-family:"Trebuchet MS";font-style:italic;color:#07e56a;font-weight:700}.c5{font-size:9pt;font-family:"Courier New";font-style:italic;color:#ce9178;font-weight:400}.c13{font-size:18pt;font-family:"Yellowtail";font-style:italic;font-weight:400}.c33{font-weight:400;font-size:11pt;font-family:"Source Sans Pro";font-style:normal}.c38{background-color:#ffffff;max-width:468pt;padding:50.4pt 72pt 50.4pt 72pt}.c30{-webkit-text-decoration-skip:none;text-decoration:underline;text-decoration-skip-ink:none}.c34{padding:0;margin:0}.c24{margin-left:36pt;padding-left:0pt}.c17{text-decoration:none;vertical-align:baseline}.c14{color:inherit;text-decoration:inherit}.c20{height:11pt}.c39{color:#5e2b97}.c18{color:#666666}.c2{background-color:#2f2f2f}.title{padding-top:0pt;color:#5e2b97;font-size:36pt;padding-bottom:0pt;font-family:"Yanone Kaffeesatz";line-height:1.0;orphans:2;widows:2;text-align:left}.subtitle{padding-top:10pt;color:#ec7b00;font-size:11pt;padding-bottom:0pt;font-family:"Source Sans Pro";line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#666666;font-size:11pt;font-family:"Source Sans Pro"}p{margin:0;color:#666666;font-size:11pt;font-family:"Source Sans Pro"}h1{padding-top:16pt;color:#434343;font-size:42pt;padding-bottom:0pt;font-family:"Yanone Kaffeesatz";line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:24pt;color:#434343;font-weight:700;font-size:16pt;padding-bottom:0pt;font-family:"Source Sans Pro";line-height:1.15;orphans:2;widows:2;text-align:left}h3{padding-top:10pt;color:#b7b7b7;font-size:10pt;padding-bottom:0pt;font-family:"Source Sans Pro";line-height:1.0;text-align:left}h4{padding-top:10pt;color:#ec7b00;font-size:11pt;padding-bottom:0pt;font-family:"Source Sans Pro";line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:8pt;color:#666666;font-size:11pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:8pt;color:#666666;font-size:11pt;padding-bottom:0pt;font-family:"Trebuchet MS";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c38 doc-content"><div><p class="c8"><span class="c33 c17 c18"></span></p><p class="c8"><span class="c33 c17 c18"></span></p><p class="c8"><span class="c17 c18 c33"></span></p></div><p class="c36 title" id="h.4gjyghbaieju"><span class="c17 c22">Dataweave with map, function and filter</span></p><p class="c36 title" id="h.pvhx27esp35o"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 5.33px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image7.png" style="width: 624.00px; height: 5.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="horizontal line"></span></p><p class="c25"><span class="c13 c17 c18">Scenario</span></p><p class="c1"><span class="c3">We have an </span><span class="c27">Opportunity:</span><span class="c3">&nbsp;</span><span class="c27">Saito - Ground-mounted Panels </span><span class="c3">with 2 products</span><span class="c9">&nbsp;</span></p><p class="c1"><span class="c27">Product-1: </span><span class="c27"><a class="c14" href="https://www.google.com/url?q=https://playful-bear-u5t76p-dev-ed.trailblaze.lightning.force.com/lightning/r/00kbm000007MmoLAAS/view&amp;sa=D&amp;source=editors&amp;ust=1717882909869236&amp;usg=AOvVaw3WSubsTlvPtQfJJJNuH8BR">SunPower Ground</a></span><span class="c9">, </span></p><p class="c1"><span class="c27">Product-2: </span><span class="c27"><a class="c14" href="https://www.google.com/url?q=https://playful-bear-u5t76p-dev-ed.trailblaze.lightning.force.com/lightning/r/00kbm000007MmoMAAS/view&amp;sa=D&amp;source=editors&amp;ust=1717882909869757&amp;usg=AOvVaw1yP_519JlbEnikdqxNSGsQ">GreenSun Ground</a></span></p><p class="c1 c20"><span class="c9"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 237.33px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image10.png" style="width: 624.00px; height: 237.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c20"><span class="c9"></span></p><p class="c1 c20"><span class="c9"></span></p><p class="c1"><span class="c0">There are 2 quotes on the opportunity: </span></p><p class="c1"><span class="c27">Quote-1: </span><span class="c9">60 Cell Ground-mounted Panels, </span></p><p class="c1"><span class="c9">Quote-2: 80 Cell Ground-mounted Panels</span></p><p class="c1 c20"><span class="c9"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 245.33px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image2.png" style="width: 624.00px; height: 245.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c20"><span class="c9"></span></p><p class="c1"><span class="c9">Quote-1: 60 Cell Ground-mounted Panels </span></p><ul class="c34 lst-kix_ak3drdpnbdxf-0 start"><li class="c1 c24 li-bullet-0"><span class="c0">quote line item with 10 quantity of Green Sun Ground</span></li></ul><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 209.33px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image6.png" style="width: 624.00px; height: 209.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c20"><span class="c0"></span></p><p class="c1"><span class="c9">Quote-2: 80 Cell Ground-mounted Panels</span></p><ul class="c34 lst-kix_ak3drdpnbdxf-0"><li class="c1 c24 li-bullet-0"><span class="c0">quote line item with 35 quantity of SunPower Ground</span></li><li class="c1 c24 li-bullet-0"><span class="c0">quote line item with 20 quantity of GreenSun Ground </span></li></ul><p class="c1 c20"><span class="c9"></span></p><p class="c1"><span class="c3">&nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 213.33px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image5.png" style="width: 624.00px; height: 213.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c20"><span class="c9"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 5.33px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image7.png" style="width: 624.00px; height: 5.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="horizontal line"></span></p><p class="c25"><span class="c13 c17 c18">Query against Salesforce Playground Org </span></p><p class="c25"><span class="c27">Opportunity Record with name</span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 102.67px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image8.png" style="width: 624.00px; height: 102.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c25"><span class="c9">Quote with Opportunity Id</span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 94.67px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image3.png" style="width: 624.00px; height: 94.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c20"><span class="c0"></span></p><p class="c25"><span class="c27">Quote Lines with both quotes of Opportunity</span><br><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 102.67px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image4.png" style="width: 624.00px; height: 102.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c25"><span class="c13">Mule Flow Image: </span><span class="c13">get-opportunityquoteSubFlow</span></p><p class="c37"><span class="c10">&lt;</span><span class="c28">a</span><span class="c26">&nbsp;</span><span class="c15">href</span><span class="c26">=</span><span class="c5">&quot;https://github.com/madajee/estore-sfdc-system-api.git&quot;</span><span class="c26">&nbsp;</span><span class="c15">target</span><span class="c26">=</span><span class="c5">&quot;_blank&quot;</span><span class="c10">&gt;</span><span class="c26">estore-sfdc-system-api</span><span class="c10">&lt;/</span><span class="c28">a</span><span class="c10">&gt;</span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 206.67px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image9.png" style="width: 624.00px; height: 206.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c25"><span class="c0">One can clone the mule repository, connect to the trailhead playground, and set up the data in their trailhead playground for Opportunity, Quotes and Quotes Lines. </span></p><p class="c25"><span class="c0">Request:</span></p><p class="c32"><span class="c31">curl </span><span class="c29">--</span><span class="c31">location </span><span class="c35">&#39;http://localhost:8081/api/opportunity/quote?opportunityname=Saito%20-%20Ground-mounted%20Panels&#39;</span></p><p class="c25"><span class="c0">Response:</span></p><p class="c25"><span class="c27">{&quot;response&quot;:{&quot;message&quot;:&quot;get quote by opportunity successful&quot;,&quot;payload&quot;:[{&quot;name&quot;:&quot;80 Cell Ground-mounted Panels&quot;,&quot;opportunityname&quot;:&quot;Saito - Ground-mounted Panels&quot;,&quot;quoteId&quot;:&quot;0Q0bm0000003JpJCAU&quot;,&quot;quotelines&quot;:[{&quot;productname&quot;:&quot;SunPower Ground&quot;,&quot;quantity&quot;:&quot;35.0&quot;},{&quot;productname&quot;:&quot;GreenSun Ground&quot;,&quot;quantity&quot;:&quot;20.0&quot;}]},{&quot;name&quot;:&quot;60 Cell Ground-mounted Panels&quot;,&quot;opportunityname&quot;:&quot;Saito - Ground-mounted Panels&quot;,&quot;quoteId&quot;:&quot;0Q0bm0000003LO5CAM&quot;,&quot;quotelines&quot;:[{&quot;productname&quot;:&quot;GreenSun Ground&quot;,&quot;quantity&quot;:&quot;10.0&quot;}]}]}}</span></p><p class="c25"><span class="c13 c17 c18">DWL: </span></p><p class="c25"><span class="c3">Opportunity Record:</span></p><p class="c25"><span class="c9">SELECT ID, Name, Amount, CurrencyIsoCode, Pricebook2Id, TotalOpportunityQuantity, ExpectedRevenue from Opportunity where name = &#39;Saito - Ground-mounted Panels&#39;</span></p><p class="c25"><span class="c9">[{&quot;TotalOpportunityQuantity&quot;:&quot;55.0&quot;,&quot;ExpectedRevenue&quot;:&quot;474750.0&quot;,&quot;Amount&quot;:&quot;4747500.0&quot;,&quot;Pricebook2Id&quot;:&quot;01sbm0000027kY1AAI&quot;,&quot;Id&quot;:&quot;006bm000001oXt3AAE&quot;,&quot;type&quot;:&quot;Opportunity&quot;,&quot;CurrencyIsoCode&quot;:&quot;JPY&quot;,&quot;Name&quot;:&quot;Saito - Ground-mounted Panels&quot;}]</span></p><p class="c8"><span class="c9"></span></p><p class="c25"><span class="c3">Quote Records for an Opportunity:</span><span class="c9">&nbsp;Save in &nbsp;vars.opportunityquotes</span></p><p class="c25"><span class="c9">We use the value of Id from the Opportunity Response to fetch the Quote records for the opportunity.</span></p><p class="c8"><span class="c9"></span></p><p class="c1"><span class="c9">select Id, name, opportunityId, Opportunity.name from Quote Where OpportunityId = &#39;006bm000001oXt3AAE&#39; </span></p><p class="c1 c2"><span class="c19">%dw</span><span class="c11">&nbsp;</span><span class="c23">2</span><span class="c11">.</span><span class="c23 c17">0</span></p><p class="c1 c2"><span class="c21">output</span><span class="c11">&nbsp;</span><span class="c21 c17">application/java</span></p><p class="c1 c2"><span class="c21">var</span><span class="c11">&nbsp;condition1 = </span><span class="c16">&quot;select Id, name, opportunityId, Opportunity.name from Quote Where OpportunityId = &quot;</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;</span><span class="c16">&quot;&#39;&quot;</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4">vars</span><span class="c11">.opportunityrecord[</span><span class="c23">0</span><span class="c11">].Id </span><span class="c21">as</span><span class="c11">&nbsp;</span><span class="c6">String</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;</span><span class="c16 c17">&quot;&#39;&quot;</span></p><p class="c1 c2"><span class="c7">---</span></p><p class="c1 c2"><span class="c7">{</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c12">&quot;query&quot;</span><span class="c11">&nbsp;: </span><span class="c4 c17">condition1</span></p><p class="c1 c2"><span class="c7">}</span></p><p class="c8"><span class="c9"></span></p><p class="c25"><span class="c9">[{&quot;OpportunityId&quot;:&quot;006bm000001oXt3AAE&quot;,&quot;Opportunity&quot;:{&quot;Id&quot;:null,&quot;type&quot;:&quot;Opportunity&quot;,&quot;Name&quot;:&quot;Saito - Ground-mounted Panels&quot;},&quot;Id&quot;:&quot;0Q0bm0000003JpJCAU&quot;,&quot;type&quot;:&quot;Quote&quot;,&quot;Name&quot;:&quot;80 Cell Ground-mounted Panels&quot;},{&quot;OpportunityId&quot;:&quot;006bm000001oXt3AAE&quot;,&quot;Opportunity&quot;:{&quot;Id&quot;:null,&quot;type&quot;:&quot;Opportunity&quot;,&quot;Name&quot;:&quot;Saito - Ground-mounted Panels&quot;},&quot;Id&quot;:&quot;0Q0bm0000003LO5CAM&quot;,&quot;type&quot;:&quot;Quote&quot;,&quot;Name&quot;:&quot;60 Cell Ground-mounted Panels&quot;}]</span></p><p class="c25"><span class="c3">QuoteLine Records for both the Opportunity:</span><span class="c27">&nbsp;Save in &nbsp;vars.opportunityquotelines</span></p><p class="c1 c20"><span class="c0"></span></p><p class="c1"><span class="c9">select Id, Product2.name, Quantity, QuoteId from QuoteLineItem Where QuoteId IN (&#39;0Q0bm0000003JpJCAU&#39;,&#39;0Q0bm0000003LO5CAM&#39;)</span></p><p class="c1 c2"><span class="c19">%dw</span><span class="c11">&nbsp;</span><span class="c23">2</span><span class="c11">.</span><span class="c23 c17">0</span></p><p class="c1 c2"><span class="c21">output</span><span class="c11">&nbsp;</span><span class="c21 c17">application/java</span></p><p class="c1 c2"><span class="c21">var</span><span class="c11">&nbsp;condition1 = </span><span class="c16 c17">&quot;select Id, Product2.name, Quantity, QuoteId from QuoteLineItem Where QuoteId IN &quot;</span></p><p class="c1 c2"><span class="c21">var</span><span class="c11">&nbsp;condition2 = </span><span class="c16">&quot;(&quot;</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;((</span><span class="c4">vars</span><span class="c11">.opportunityquotes </span><span class="c4">map</span><span class="c11">&nbsp;() -&gt; </span><span class="c16">&quot;&#39;&quot;</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;$.Id </span><span class="c4">++</span><span class="c11">&nbsp;</span><span class="c16">&quot;&#39;&quot;</span><span class="c11">) </span><span class="c4">joinBy</span><span class="c11">&nbsp;(</span><span class="c16">&quot;,&quot;</span><span class="c11">)) </span><span class="c4">++</span><span class="c11">&nbsp;</span><span class="c16 c17">&quot;)&quot;</span></p><p class="c1 c2"><span class="c7">---</span></p><p class="c1 c2"><span class="c7">{</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c12">&quot;query&quot;</span><span class="c11">&nbsp;: </span><span class="c4">condition1</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;</span><span class="c4 c17">condition2</span></p><p class="c1 c2"><span class="c11">}</span></p><p class="c25"><span class="c9">[{&quot;Product2&quot;:{&quot;Id&quot;:null,&quot;type&quot;:&quot;Product2&quot;,&quot;Name&quot;:&quot;SunPower Ground&quot;},&quot;QuoteId&quot;:&quot;0Q0bm0000003JpJCAU&quot;,&quot;Quantity&quot;:&quot;35.0&quot;,&quot;Id&quot;:&quot;0QLbm0000001dddGAA&quot;,&quot;type&quot;:&quot;QuoteLineItem&quot;},{&quot;Product2&quot;:{&quot;Id&quot;:null,&quot;type&quot;:&quot;Product2&quot;,&quot;Name&quot;:&quot;GreenSun Ground&quot;},&quot;QuoteId&quot;:&quot;0Q0bm0000003JpJCAU&quot;,&quot;Quantity&quot;:&quot;20.0&quot;,&quot;Id&quot;:&quot;0QLbm0000001ddeGAA&quot;,&quot;type&quot;:&quot;QuoteLineItem&quot;},{&quot;Product2&quot;:{&quot;Id&quot;:null,&quot;type&quot;:&quot;Product2&quot;,&quot;Name&quot;:&quot;GreenSun Ground&quot;},&quot;QuoteId&quot;:&quot;0Q0bm0000003LO5CAM&quot;,&quot;Quantity&quot;:&quot;10.0&quot;,&quot;Id&quot;:&quot;0QLbm0000001eUsGAI&quot;,&quot;type&quot;:&quot;QuoteLineItem&quot;}]</span></p><p class="c8"><span class="c9"></span></p><p class="c25"><span class="c3">QuoteLine Records for both the Opportunity:</span><span class="c9">&nbsp;get-quote-by-opportunity-response.dwl</span></p><p class="c25"><span class="c9">See the use of map, filter and function:</span></p><p class="c1 c2"><span class="c19">%dw</span><span class="c11">&nbsp;</span><span class="c23">2</span><span class="c11">.</span><span class="c17 c23">0</span></p><p class="c1 c2"><span class="c21">output</span><span class="c11">&nbsp;</span><span class="c21 c17">application/json</span></p><p class="c1 c2"><span class="c21">fun</span><span class="c11">&nbsp;getQuotelines(</span><span class="c4">quoteId</span><span class="c11">) = </span><span class="c4">vars</span><span class="c11">.opportunityquotelines </span><span class="c4">filter</span><span class="c11">&nbsp;($.QuoteId == </span><span class="c4">quoteId</span><span class="c7">)</span></p><p class="c1 c2"><span class="c7">---</span></p><p class="c1 c2"><span class="c21">if</span><span class="c11">&nbsp;(</span><span class="c4">vars</span><span class="c11">.opportunityrecord[</span><span class="c23">0</span><span class="c11">].Id != </span><span class="c21">null</span><span class="c7">)</span></p><p class="c1 c2"><span class="c7">{</span></p><p class="c1 c2"><span class="c11">&nbsp;</span><span class="c12">response</span><span class="c7">: {</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span><span class="c12">message</span><span class="c11">: </span><span class="c16">&quot;get quote by opportunity successful&quot;</span><span class="c7">,</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span><span class="c12">payload</span><span class="c11">: &nbsp;</span><span class="c4">vars</span><span class="c11">.opportunityquotes </span><span class="c4">map</span><span class="c7">() -&gt; {</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; </span><span class="c12">name</span><span class="c7">: $.Name,</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; </span><span class="c12">opportunityname</span><span class="c7">: $.Opportunity.Name,</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; </span><span class="c12">quoteId</span><span class="c7">: $.Id,</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; </span><span class="c12">quotelines</span><span class="c11">: getQuotelines($.Id) </span><span class="c4">map</span><span class="c7">() -&gt; {</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c12">productname</span><span class="c7">: $.Product2.Name,</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c12">quantity</span><span class="c7">: $.Quantity</span></p><p class="c1 c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1 c2"><span class="c7">&nbsp;}</span></p><p class="c1 c2"><span class="c11">} </span><span class="c21">as</span><span class="c11">&nbsp;</span><span class="c6">Object</span><span class="c11">&nbsp;</span><span class="c6">{</span><span class="c12">encoding</span><span class="c6">:</span><span class="c11">&nbsp;</span><span class="c16">&quot;UTF-8&quot;</span><span class="c6">,</span><span class="c11">&nbsp;</span><span class="c12">mediaType</span><span class="c6">:</span><span class="c11">&nbsp;</span><span class="c16">&quot;application/</span><span class="c16 c30">json</span><span class="c16">&quot;</span><span class="c6 c17">}</span></p><p class="c1 c2"><span class="c21">else</span><span class="c7">&nbsp;{</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c12">response</span><span class="c7">: {</span></p><p class="c1 c2"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span><span class="c12">message</span><span class="c11">: </span><span class="c16">&quot;</span><span class="c16 c30">Opporutnity</span><span class="c16">&nbsp;with name: &quot;</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;</span><span class="c4">vars</span><span class="c11">.queryparameters.opportunityname </span><span class="c21">as</span><span class="c11">&nbsp;</span><span class="c6">String</span><span class="c11">&nbsp;</span><span class="c4">++</span><span class="c11">&nbsp;</span><span class="c16">&quot; </span><span class="c16 c30">doesnot</span><span class="c16">&nbsp;exists, please check.&quot;</span><span class="c7">,</span></p><p class="c1 c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c1 c2"><span class="c11">} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c21">as</span><span class="c11">&nbsp;</span><span class="c6">Object</span><span class="c11">&nbsp;</span><span class="c6">{</span><span class="c12">encoding</span><span class="c6">:</span><span class="c11">&nbsp;</span><span class="c16">&quot;UTF-8&quot;</span><span class="c6">,</span><span class="c11">&nbsp;</span><span class="c12">mediaType</span><span class="c6">:</span><span class="c11">&nbsp;</span><span class="c16">&quot;application/</span><span class="c16 c30">json</span><span class="c16">&quot;</span><span class="c6 c17">}</span></p><p class="c25"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 351.17px;"><img alt="" src="images/get-quotes-for-opportunity-dwl/image1.png" style="width: 624.00px; height: 351.17px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c8"><span class="c9"></span></p></body></html>